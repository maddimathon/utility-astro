///
/// @package @maddimathon/utility-astro@0.1.0-alpha.2
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/feature-check';
@use 'pkg:@maddimathon/utility-sass/selector';

@use 'pkg:@maddimathon/utility-sass/03-snippets' as utils;

@use '../01-functions' as *;
@use '../02-mixins' as *;

@use 'content' as *;

// prettier-ignore
$_default_grid_page: snippet-support-astro-content--default-grid-page();

$_titleBorderWidth: var-border-width('200');
$_titleBorderWidth_half: var-border-width('100');

///
/// Supports the ToggleNavMenu astro component.
///
@mixin snippet-support-astro-toggle-nav-menu {
    %body {
        > %nav {
            @at-root #{selector.unify(&, ('[data-toggle-container]'))} {
                @include snippet-support-astro-content--page-width;
            }
        }
    }

    @include feature-check.js-support(whereSelector) {
        %body {
            > %nav {
                @at-root #{selector.unify(&, ('[data-toggle-container]'))} {
                    // prettier-ignore
                    $_gridCols_toggle: var(--grid-template-columns--page, #{$_default_grid_page});
                    /* prettier-ignore */
                    --grid-template-columns--toggle: #{ $_gridCols_toggle};
                    /* prettier-ignore */
                    grid-template-columns: var(--grid-template-columns--page, #{$_default_grid_page});
                    grid-template-columns: subgrid;

                    justify-content: center;
                    justify-items: center;
                    align-content: center;
                    align-items: center;

                    grid-column: 1 / -1;

                    padding: 0;

                    .toggle-title,
                    [data-toggle-content] {
                        grid-column: 1 / -1;

                        gap: 0;
                    }

                    [data-toggle-content] {
                        margin-block-end: #{$_titleBorderWidth_half};
                        padding: 0;
                        border: none;

                        > .container {
                            @include snippet-support-astro-content--page-width;

                            padding-inline: #{var-mrg-firm('400')};
                            background: #{var-sys-colour(background)};

                            > ol,
                            > ul {
                                margin-inline-start: 0;
                            }
                        }
                    }

                    .toggle-title {
                        /* prettier-ignore */
                        grid-template-columns: var(--grid-template-columns--toggle, var(--grid-template-columns--page, #{$_default_grid_page}));
                        grid-template-columns: subgrid;

                        align-content: stretch;
                        align-items: center;

                        margin-block-end: calc(#{$_titleBorderWidth} * -1);
                        border-block-end: #{$_titleBorderWidth} solid
                            currentColor;

                        font-size: #{var-fs(heading-6)};
                        background: #{var-sys-colour(background)};

                        [data-toggle-control] {
                            @include snippet-support-astro-content--page-width;

                            // prettier-ignore
                            $_gridCols_toggle: [content] 1fr #{var-gap-inline(tab)} [icon] minmax(max-content, auto);
                            /* prettier-ignore */
                            --grid-template-columns--toggle: #{ $_gridCols_toggle};
                            /* prettier-ignore */
                            grid-template-columns: var(--grid-template-columns--toggle, #{$_gridCols_toggle});

                            justify-content: space-between;
                            justify-items: start;
                            align-items: center;

                            gap: 0;

                            width: 100%;
                        }
                    }
                }

                @at-root #{selector.unify(&, ('[data-toggle-container=open]'))},
                    #{selector.unify(&, ('[data-toggle-container=closing]'))} {
                    > [data-toggle-content] {
                        > .container {
                            border: #{$_titleBorderWidth} dotted currentColor;
                            border-block-start: none;
                        }
                    }
                }

                @at-root #{selector.unify(&, ('[data-toggle-container=open]'))} {
                    > [data-toggle-content] {
                        margin-block-end: #{var-mrg-firm('400')};

                        > .container {
                            padding-block: #{var-mrg-soft('400')};
                        }
                    }
                }
            }
        }
    }
}
