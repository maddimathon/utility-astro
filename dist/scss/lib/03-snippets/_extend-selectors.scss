///
/// @package @maddimathon/utility-astro@0.1.0-alpha.8
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/selector';

@use 'pkg:@maddimathon/utility-sass/03-snippets' as lib;

@use '../../config';

@use '../01-functions' as *;
// @use '../02-mixins' as *;

$_astroContentLayoutSelectors: if(
    config.$print_astro_content,
    to-extend-selector-content-layout(),
    ()
);

@mixin extend-selectors-globals(
    $additional: (),
    $optional: null,
    $allHeadingLevels: token-all-heading-levels()
) {
    //
    $additional: list.append($additional, (nav));
    $additional: list.append(
        $additional,
        (
            (
                ':where(.js) [data-toggle-control][data-toggle-is-current-target]'
            ),
            focus-ring--where
        )
    );

    @if config.$print_astro_content and not config.$print_utils {
        $additional: list.join(
            $additional,
            $_astroContentLayoutSelectors,
            $separator: comma
        );
    }

    @include lib.extend-selectors-globals(
        $additional: $additional,
        $optional: $optional,
        $allHeadingLevels: $allHeadingLevels
    );
}

@mixin extend-selectors-utils(
    $additional: (),
    $optional: null,
    $allHeadingLevels: token-all-heading-levels()
) {
    //
    // $additional: list.append($additional, ('.icon', 'icon'));

    @if config.$print_astro_content {
        $additional: list.join(
            $additional,
            $_astroContentLayoutSelectors,
            $separator: comma
        );
    }

    @if config.$print_astro_toggle {
        $_baseLevelListSelector: (
            '.table-of-contents [data-toggle-content] > .container ol',
            '.table-of-contents > ol'
        );
        $_baseLevelListSelector_lvl2: selector.nest(
            $_baseLevelListSelector,
            'ol, ul'
        );

        $additional: list.join(
            $additional,
            (
                ($_baseLevelListSelector, 'ul'),
                ($_baseLevelListSelector_lvl2, 'ul-2'),
                (selector.nest($_baseLevelListSelector_lvl2, 'ol, ul'), 'ul-3')
            ),
            $separator: comma
        );
    }

    @include lib.extend-selectors-utils(
        $additional: $additional,
        $optional: $optional,
        $allHeadingLevels: $allHeadingLevels
    );
}

@mixin extend-selectors(
    $optional: null,
    $additional_globals: (),
    $additional_utils: (),
    $allHeadingLevels: token-all-heading-levels()
) {
    @if config.$print_globals {
        @include extend-selectors-globals(
            $additional: $additional_globals,
            $optional: $optional,
            $allHeadingLevels: $allHeadingLevels
        );
    }

    @if config.$print_utils {
        @include extend-selectors-utils(
            $additional: $additional_utils,
            $optional: $optional,
            $allHeadingLevels: $allHeadingLevels
        );
    }
}
