---
/**
 * @since 0.1.0-alpha
 *
 * @packageDocumentation
 */

/* import - types */
import type { GenericElementProps } from '../../ts/00-types/index.js';
import type { NavMenuProps } from './NavMenu.astro';

/* import - functions */
import { parseMenuItem } from './NavMenu.astro';

/* import - values */

/* import - components */
import MenuList from './MenuList.astro';
import Toggle_Control from '../support/Toggle_Control.astro';

/* import - layouts */

/* TYPES ===================================== */

/**
 * Input props for the ToggleNavMenu component.
 *
 * @since 0.1.0-alpha
 * @since 0.1.0-alpha.17 â€” Moved to component file.
 */
export interface ToggleNavMenuProps extends NavMenuProps {}

/* PROPS ===================================== */

export interface Props extends GenericElementProps<ToggleNavMenuProps, 'div'> {}

const {
    class: classList = [],
    convertHrefStringsToAbsolute = null,
    id: menuID,
    menu,
    ...attributes
}: Props = Astro.props.frontmatter ?? Astro.props;

/* CONSTANTS ===================================== */

const parsedMenu = menu.map((_item) =>
    parseMenuItem(Astro.url, _item, convertHrefStringsToAbsolute),
);

const id = `${menuID}-toggle`;

const buttonID = `${id}-button`;
const contentID = `${id}-content`;
const titleID = `${id}-title`;
---

<nav
    {...attributes}
    id={id}
    data-toggle-container
    class:list={classList}
    role='navigation'
>
    <div
        id={titleID}
        class='toggle-title'
    >
        <Toggle_Control
            {...{ id, buttonID }}
            set:text='Menu'
            data-toggle-primary-control={id}
        />
    </div>

    <div
        aria-labelledby={titleID}
        data-toggle-content={id}
        id={contentID}
    >
        <div class='container'><MenuList menu={parsedMenu} /></div>
    </div>

    <div
        data-toggle-control={id}
        data-toggle-control-backdrop={id}
        class='toggle-nav-menu__backdrop'
        aria-hidden='true'
    >
    </div>
</nav>
