---
/**
 * To use this component, your page MUST include the Toggle_Scripts components
 * and sass styles snippet (or replacements), otherwise this will not work.
 *
 * @since 0.1.0-alpha.draft
 *
 * @packageDocumentation
 */

/* import - types */
import type { ElementProps } from '../../ts/00-types/index.js';

/* import - functions */

/* import - values */

/* import - components */
import Heading from './Heading.astro';
import Toggle_Control from '../support/Toggle_Control.astro';

/* import - layouts */

/* PROPS ===================================== */

/**
 * Input props for the Toggle component.
 *
 * @since 0.1.0-alpha.draft
 */
export interface ToggleProps {
    children: any; // these are the slots

    /**
     * Unique id attr.
     */
    id: string;

    defaultOpen?: boolean;

    /**
     * If any, the heading display level override for this heading (otherwise
     * the `heading` value is used).
     */
    displayHeading?: number;

    /**
     * If any, the heading level used to wrap the toggle button.
     */
    heading?: number | false;
}

export interface Props extends ElementProps<ToggleProps, 'div'> {}

const {
    defaultOpen,
    displayHeading,
    heading,
    id,
    class: classList = [],
    ...attributes
}: Props = Astro.props;

/* CONSTANTS ===================================== */

const buttonID = `${id}-button`;
const contentID = `${id}-content`;
const titleID = `${id}-title`;
---

<section
    id={id}
    class:list={classList}
    {...attributes}
    data-toggle-container={defaultOpen ? 'open' : 'closed'}
>
    <header
        id={titleID}
        class='toggle-title'
    >
        {
            heading ? (
                <Heading
                    heading={heading}
                    displayHeading={displayHeading}
                >
                    <Toggle_Control
                        {...{ id, buttonID }}
                        data-toggle-primary-control={id}
                    >
                        <slot name='button' />
                    </Toggle_Control>
                </Heading>
            ) : (
                <Toggle_Control
                    class:list={`h${displayHeading ?? 7}`}
                    {...{ id, buttonID }}
                    data-toggle-primary-control={id}
                >
                    <slot name='button' />
                </Toggle_Control>
            )
        }
    </header>

    <div
        aria-labelledby={titleID}
        data-toggle-content={id}
        id={contentID}
    >
        <div class='container'><slot /></div>
    </div>
</section>
