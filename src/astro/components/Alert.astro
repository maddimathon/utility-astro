---
/**
 * @since 0.1.0-alpha
 *
 * @packageDocumentation
 */

/* import - types */
import type { HTMLAttributes } from 'astro/types';
import type { ClassList } from '../../ts/00-types/index.js';
import type { IconProps } from './Icon.astro';

/* import - functions */

/* import - values */

/* import - components */
import Icon from './Icon.astro';
import Heading from './Heading.astro';

/* import - layouts */

/* TYPES ===================================== */

type AlertProps_Slug = {
    class?: ClassList;
    heading?: number;

    type: IconProps['type'];

    slug?: never;
    svg?: never;
    svgLabel?: never;
};

type AlertProps_Svg = {
    class?: ClassList;
    heading?: number;

    type?: never;

    slug: string;
    svg: string;
    svgLabel: string;
};

/**
 * Input props for the Alert component.
 *
 * @since 0.1.0-alpha
 * @since 0.1.0-alpha.17 â€” Moved to component file and renamed to AlertProps.
 */
export type AlertProps = AlertProps_Slug | AlertProps_Svg;

/* PROPS ===================================== */

// prettier-ignore
export type Props = AlertProps & Partial<Omit<HTMLAttributes<'section'>, keyof AlertProps|'class'|'class:list'>>;

const {
    heading,
    slug,
    svg,
    svgLabel,
    type = 'star',
    class: classList = [],
    ...attributes
}: Props = Astro.props;

/* CONSTANTS ===================================== */

const headlineHTML = (await Astro.slots.render('headline'))?.trim() || false;
---

<section
    {...attributes}
    class:list={[
        'alert-block',
        `alert-block--${slug ?? type}`,
        '||',
        classList,
    ]}
>
    {
        !headlineHTML ? (
            svg ? (
                <Icon
                    slug={slug}
                    svg={svg}
                    svgLabel={svgLabel}
                />
            ) : (
                <Icon type={type} />
            )
        ) : heading ? (
            <Heading
                heading={heading}
                class='alert-block__headline'
            >
                {svg ? (
                    <Icon
                        slug={slug}
                        svg={svg}
                        svgLabel={svgLabel}
                    />
                ) : (
                    <Icon type={type} />
                )}
                <Fragment set:html={headlineHTML} />
            </Heading>
        ) : (
            <header class='alert-block__headline'>
                {svg ? (
                    <Icon
                        slug={slug}
                        svg={svg}
                        svgLabel={svgLabel}
                    />
                ) : (
                    <Icon type={type} />
                )}
                <Fragment set:html={headlineHTML} />
            </header>
        )
    }
    <slot />
</section>
